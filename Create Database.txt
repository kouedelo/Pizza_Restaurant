CREATE DATABASE Pizza_restaurant;


USE Pizza_restaurant;




CREATE TABLE CUSTOMER(
phone_number                    varchar(20)          NOT NULL,
password                        varchar(30)          NOT NULL,
email                           varchar(30),
first_name                      varchar(30)          NOT NULL,
last_name                       varchar(30)          NOT NULL,
city                            varchar(30)          NOT NULL,
state                           varchar(30)          NOT NULL,
zip_code                        varchar(30)          NOT NULL,

CONSTRAINT CUSTOMER_PK
       PRIMARY KEY(phone_number,password)
);




CREATE TABLE CASH(
payment_id                     varchar(20)           NOT NULL,
number_of_bank_notes           int                   NOT NULL, 
type_of_bank_note              varchar(20)           NOT NULL,

CONSTRAINT CASH_PK
       PRIMARY KEY(payment_id)    
);



CREATE TABLE CHECK_PAYMENT(
payment_id                     varchar(20)           NOT NULL,
check_issuer                   varchar(20)           NOT NULL,
reference                      varchar(20)           NOT NULL,
bank                           varchar(20)           NOT NULL,

CONSTRAINT CHECK_PK
       PRIMARY KEY(payment_id)
);




CREATE TABLE CARD(
payment_id                     varchar(20)           NOT NULL,
cvc                            varchar(20)           NOT NULL,
card_number                    varchar(20)           NOT NULL,
zip_code                       varchar(20)           NOT NULL,
Name_on_card                   varchar(20)           NOT NULL,
exp_date                       varchar(20)           NOT NULL,

CONSTRAINT CARD_PK
       PRIMARY KEY(payment_id)
);




CREATE TABLE ORDER_TABLE(
order_id                       varchar(20)           NOT NULL,

CONSTRAINT ORDER_PK
       PRIMARY KEY(order_id)
);




CREATE TABLE PIZZA(
item_id                        varchar(20)           NOT NULL,
pizza_size                     varchar(20)           NOT NULL,
crust                          varchar(20)           NOT NULL,
quantity                       int                   NOT NULL,
price                          double                NOT NULL,

CONSTRAINT PIZZA_PK
       PRIMARY KEY(item_id)
);




CREATE TABLE PIZZA_TOPPING(
pizza_item_id                   varchar(20)           NOT NULL,
topping_name                    varchar(20)           NOT NULL,
price                           double                NOT NULL,

CONSTRAINT PIZZA_TOPPING_PK
       PRIMARY KEY(pizza_item_id,topping_name),

CONSTRAINT PIZZA_TOPPING_FK
       FOREIGN KEY(pizza_item_id) REFERENCES PIZZA(item_id)
            ON DELETE CASCADE   ON UPDATE CASCADE
);




CREATE TABLE BEVERAGE(
item_id                        varchar(20)           NOT NULL,
name                           varchar(20)           NOT NULL,
quantity                       int                   NOT NULL,
price                          double                NOT NULL,

CONSTRAINT BEVERAGE_PK
       PRIMARY KEY(item_id,name)
);




CREATE TABLE SIDES(
item_id                        varchar(20)           NOT NULL,
name                           varchar(20)           NOT NULL,
quantity                       int                   NOT NULL,
price                          double                NOT NULL,

CONSTRAINT SIDES_PK
       PRIMARY KEY(item_id,name)
);




CREATE TABLE MAKES_ORDER(
phone_number                       varchar(20)           NOT NULL,
order_id                           varchar(20)           NOT NULL,

CONSTRAINT MAKES_ORDER_PK
       PRIMARY KEY(phone_number,order_id),

CONSTRAINT MAKES_ORDER_CUSTOMER_FK
       FOREIGN KEY(phone_number) REFERENCES CUSTOMER(phone_number)
            ON DELETE CASCADE   ON UPDATE CASCADE,

CONSTRAINT MAKES_ORDER_ORDER_FK
       FOREIGN KEY(order_id) REFERENCES ORDER_TABLE(order_id)
            ON DELETE CASCADE   ON UPDATE CASCADE
);




CREATE TABLE ORDER_ITEM(
item_id                       varchar(20)           NOT NULL,

CONSTRAINT ORDER_ITEM_PK
       PRIMARY KEY(item_id)
);





CREATE TABLE BELONGS_TO(
item_id                            varchar(20)           NOT NULL,
order_id                           varchar(20)           NOT NULL,
cost                               double                NOT NULL,

CONSTRAINT BELONGS_TO_PK
       PRIMARY KEY(item_id,order_id),

CONSTRAINT BELONGS_TO_ORDER_ITEM_FK
       FOREIGN KEY(item_id) REFERENCES ORDER_ITEM(item_id)
            ON DELETE CASCADE   ON UPDATE CASCADE,

CONSTRAINT BELONGS_TO_ORDER_FK
       FOREIGN KEY(order_id) REFERENCES ORDER_TABLE(order_id)
            ON DELETE CASCADE   ON UPDATE CASCADE
);



CREATE TABLE PAYMENT_METHOD(
item_id                            varchar(20)           NOT NULL,
order_id                           varchar(20)           NOT NULL,
date                               varchar(20)           NOT NULL,

CONSTRAINT PAYMENT_METHOD_PK
       PRIMARY KEY(item_id,order_id),

CONSTRAINT PAYMENT_METHOD_ORDER_FK
       FOREIGN KEY(order_id) REFERENCES ORDER_TABLE(order_id)
            ON DELETE CASCADE   ON UPDATE CASCADE
);